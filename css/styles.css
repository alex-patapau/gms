/*
 * ИСПРАВЛЕНИЯ ОТОБРАЖЕНИЯ PDF-ВЬЮЕРА:
 * 
 * Проблема 1: При открытии документа было видно только 1/4 окна, правый нижний угол 
 * находился в центре экрана из-за неправильного позиционирования.
 * 
 * Исправления (проблема 1):
 * 1. Заменены проценты (%) на vw/vh единицы для размеров окна на десктопе
 * 2. Удален конфликтующий transform: translateY(0) из .pdf-viewer-content
 * 3. Исправлена анимация: заменен translate(-50%, -50%) на scale для совместимости
 *    с flexbox центрированием
 * 4. Добавлены max-width и max-height ограничения для предотвращения выхода
 *    окна за границы экрана
 * 5. Улучшено позиционирование canvas элементов PDF (центрирование, overflow)
 * 6. Добавлен min-height: 0 для flex-контейнера с overflow
 * 
 * Проблема 2: Предзагружалась только первая страница, не было возможности прокрутить
 * до конца документа. На мобильных устройствах использовались vw/vh (98% экрана),
 * а не проценты от окна браузера.
 * 
 * Исправления (проблема 2):
 * 7. Изменена логика рендеринга: рендерятся все страницы сразу при загрузке PDF
 *    для возможности скроллинга через весь документ
 * 8. На мобильных устройствах размеры изменены с vw/vh на проценты (98%)
 *    от размера окна браузера (родительского контейнера)
 * 9. Добавлен обработчик скролла для автоматического обновления текущей страницы
 *    при прокрутке документа
 * 10. Обновлены обработчики навигации (кнопки, клавиатура, свайпы) для использования
 *     скролла к странице вместо перерендеринга всех страниц
 * 
 * Проблема 3: Некорректное позиционирование элементов управления (zoom-controls и navigation)
 * на мобильных устройствах.
 * 
 * Исправления (проблема 3):
 * 11. Исправлено позиционирование элементов управления на мобильных устройствах:
 *     - Контейнер .pdf-controls изменен на вертикальное расположение (flex-direction: column)
 *     - Элементы центрированы по горизонтали и вертикали (align-items: center, justify-content: center)
 *     - zoom-controls и navigation центрированы внутри своего контейнера
 *     - Добавлены подробные комментарии, объясняющие логику позиционирования
 *     - Десктопная версия осталась без изменений
 */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #f5f5f5;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.open-pdf-btn {
    background-color: #4a6ee0;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}
/* Overlay viewer - hidden by default, shown when .active is added */
/* ИСПРАВЛЕНО: Правильное центрирование контейнера через flexbox */
.pdf-viewer {
    position: fixed;
    inset: 0;
    display: none; /* hidden until opened */
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.6);
    z-index: 9999;
    /* Убеждаемся, что overlay занимает весь экран */
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
}

.pdf-viewer.active {
    display: flex;
}

/* ИСПРАВЛЕНО: Правильное позиционирование и размеры контента */
/* Убран transform: translateY(0) который конфликтовал с центрированием */
.pdf-viewer-content {
    position: relative;
    /* ИСПРАВЛЕНО: Используем max-width и max-height вместо фиксированных размеров */
    /* Это позволяет окну адаптироваться, но не выходить за границы экрана */
    width: 90vw; /* 90% от ширины viewport */
    height: 90vh; /* 90% от высоты viewport */
    max-width: 90vw; /* Ограничиваем максимальную ширину */
    max-height: 90vh; /* Ограничиваем максимальную высоту */
    /* ИСПРАВЛЕНО: box-sizing гарантирует, что padding/border включены в размеры */
    box-sizing: border-box;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    /* ИСПРАВЛЕНО: Убрали transform который нарушал центрирование */
    /* Контейнер центрируется через flexbox родителя */
}

.pdf-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background-color: #f0f0f0;
    border-bottom: 1px solid #ddd;
}

.pdf-title {
    font-weight: bold;
    color: #333;
    margin: 0;
}

.pdf-close {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #555;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s;
}

.pdf-close:hover {
    background-color: rgba(0, 0, 0, 0.1);
}

/* ИСПРАВЛЕНО: Правильное позиционирование контейнера PDF-контента */
.pdf-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: auto; /* ИСПРАВЛЕНО: Добавлен горизонтальный скролл для широких PDF */
    position: relative;
    padding: 20px;
    background: #f8f8f8;
    /* ИСПРАВЛЕНО: Убеждаемся, что контент занимает доступное пространство */
    min-height: 0; /* Важно для flex-контейнеров с overflow */
}

/* ИСПРАВЛЕНО: Правильное позиционирование контейнера страниц PDF */
.pdf-pages-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    padding: 20px;
    max-width: 100%;
    /* ИСПРАВЛЕНО: Убеждаемся, что контейнер не выходит за границы */
    box-sizing: border-box;
    width: 100%;
}

/* ИСПРАВЛЕНО: Правильное позиционирование canvas элементов PDF */
.pdf-page {
    background: white;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    max-width: 100%;
    height: auto;
    /* ИСПРАВЛЕНО: Убеждаемся, что canvas не выходит за границы контейнера */
    display: block;
    margin: 0 auto; /* Центрируем canvas внутри контейнера */
}

.pdf-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background-color: #f0f0f0;
    border-top: 1px solid #ddd;
}

/* Анимации для лайтбокса */
/* ИСПРАВЛЕНО: Анимация fadeIn для overlay */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* ИСПРАВЛЕНО: Анимация slideInScale для контента, совместимая с flexbox центрированием */
/* Используем scale и opacity вместо translate, так как центрирование через flexbox */
@keyframes slideInScale {
    from { 
        transform: scale(0.9);
        opacity: 0;
    }
    to { 
        transform: scale(1);
        opacity: 1;
    }
}

/* ИСПРАВЛЕНО: Применяем анимацию которая не конфликтует с flexbox центрированием */
.pdf-viewer.active .pdf-viewer-content {
    animation: slideInScale 0.3s ease forwards;
}

/* Мобильные стили */
/* ИСПРАВЛЕНО: Адаптивные размеры для мобильных устройств */
@media (max-width: 768px) {
    .pdf-viewer-content {
        /* ИСПРАВЛЕНО: Используем проценты от размера окна браузера, а не vw/vh */
        /* Проценты берутся от родительского контейнера (.pdf-viewer), который занимает 100% экрана */
        width: 98%; /* 98% от размера окна браузера (от .pdf-viewer) */
        height: 98%; /* 98% от размера окна браузера (от .pdf-viewer) */
        max-width: 98%; /* Ограничиваем максимальную ширину */
        max-height: 98%; /* Ограничиваем максимальную высоту */
        /* Гарантируем, что окно не выходит за границы окна браузера */
    }

    /* ИСПРАВЛЕНО: Позиционирование элементов управления на мобильных устройствах */
    /* Логика позиционирования: контейнер .pdf-controls изменяет направление на вертикальное,
       а дочерние элементы (zoom-controls и navigation) центрируются по горизонтали */
    .pdf-controls {
        /* Изменяем направление flex на вертикальное для расположения элементов друг под другом */
        flex-direction: column;
        /* Центрируем элементы по горизонтали (ось cross-axis при column direction) */
        align-items: center;
        /* Центрируем элементы по вертикали (ось main-axis при column direction) */
        justify-content: center;
        /* Добавляем отступ между элементами */
        gap: 15px;
        /* Уменьшаем горизонтальные отступы для мобильных */
        padding: 15px 10px;
        /* Убираем flex-wrap так как элементы теперь в колонке */
    }

    /* ИСПРАВЛЕНО: Центрирование zoom-controls на мобильных */
    /* Логика: элементы зума центрируются внутри своего контейнера,
       который теперь центрирован в .pdf-controls */
    .zoom-controls {
        /* Обеспечиваем горизонтальное центрирование элементов зума */
        justify-content: center;
        /* Убеждаемся, что контейнер не растягивается на всю ширину */
        width: auto;
    }

    /* ИСПРАВЛЕНО: Центрирование navigation на мобильных */
    /* Логика: элементы навигации центрируются внутри своего контейнера,
       который теперь центрирован в .pdf-controls */
    .navigation {
        /* Центрируем элементы навигации по горизонтали */
        display: flex;
        justify-content: center;
        align-items: center;
        /* Добавляем небольшой gap между элементами навигации */
        gap: 10px;
        /* Убеждаемся, что контейнер не растягивается на всю ширину */
        width: auto;
        /* Позволяем перенос элементов если не хватает места */
        flex-wrap: wrap;
    }

    .pdf-content {
        padding: 10px;
        -webkit-overflow-scrolling: touch; /* Плавный скролл на iOS */
    }

    .pdf-page {
        max-width: 100%;
        height: auto;
        image-rendering: -webkit-optimize-contrast; /* Улучшенное качество на webkit */
        image-rendering: crisp-edges; /* Улучшенное качество на других браузерах */
    }
}

/* Стили для навигации */
.nav-btn {
    background-color: #4a6ee0;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
}

.nav-btn:disabled {
    background-color: #aaa;
    cursor: not-allowed;
}

.nav-btn:hover:not(:disabled) {
    background-color: #3a5ec0;
}

.page-info {
    font-size: 14px;
    color: #555;
}

/* Стили для навигации - базовые стили для десктопной версии */
.navigation {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Стили для зума */
.zoom-controls {
    display: flex;
    align-items: center;
    gap: 10px;
}

.zoom-btn {
    background: none;
    border: 1px solid #ddd;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
}

.zoom-btn:hover {
    background-color: #e9e9e9;
}

/* Индикаторы загрузки */
.loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 15px 25px;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    font-size: 14px;
    display: none;
}

.loading.active {
    display: block;
    animation: fadeIn 0.2s ease;
}

